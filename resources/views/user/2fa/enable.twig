{#
This file is part of sleeti.
Copyright (C) 2016  Eliot Partridge

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
#}

{% extends 'templates/app.twig' %}

{% block title %}2FA Settings{% endblock %}

{% block content %}
	<div class="row">
		<div class="col-md-6 col-md-offset-3">
			<div class="panel panel-default">
				<div class="panel-heading">
					<h3 class="panel-title">Two factor authentication settings</h3>
				</div>

				<div class="panel-body">
					<p class="lead">
						Need a two factor auth app? <a href="https://www.authy.com/app/mobile/">Try Authy</a>!
					</p>

					<form action="{{ path_for('user.profile.2fa') }}" method="post" autocomplete="off">
						<div class="checkbox">
							<label>
								<input type="checkbox" name="enable" value="1"{% if auth.user.settings.tfa_secret != null %} checked{% endif %}>
								Enable two factor authentication
							</label>
						</div>

						<button type="submit" class="btn btn-default">Submit</button>

						{{ csrf.field | raw }}
					</form>
				</div>
			</div>
		</div>
	</div>
{% endblock %}
